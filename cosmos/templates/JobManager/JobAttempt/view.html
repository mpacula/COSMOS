{% extends "base.html" %}
{% load extras %}

{%block content%}


<ul class="breadcrumb">
  <li><a href="/Workflow/">Workflows</a> <span class="divider">/</span></li>
  <li><a href="{{jobAttempt.task.stage.workflow.url }}">{{jobAttempt.task.stage.workflow}}</a> <span class="divider">/</span></li>
  <li><a href="{{jobAttempt.task.stage.url }}">{{jobAttempt.task.stage}}</a><span class="divider">/</span></li>
  <li><a href="{{jobAttempt.task.url }}">{{jobAttempt.task}}</a><span class="divider">/</span></li>
  <li class="active">{{jobAttempt}}</li>
</ul>
<div class="alert {% with qs=jobAttempt.queue_status %}
            {%if jobAttempt.successful%}alert-success{%else%}
            {%if qs == "completed"%}alert-error{%endif%}{%endif%}
        {% endwith%}">
    <h1>
        {% with qs=jobAttempt.queue_status %}
            {%if jobAttempt.successful%}<i class="icon-thumbs-up" rel="tooltip" title="Successful"></i>{%else%}
            {%if qs == "completed"%}<i class="icon-thumbs-down" rel="tooltip" title="Successful"></i>{%endif%}{%endif%}
            {%if qs == 'queued'%}<i class="icon-time" rel="tooltip" title="Job is Queued"></i>
                {%with ds=jobAttempt.get_drmaa_status %}
                    {%if ds == 'job is running'%}<i class="icon-refresh" rel="tooltip" title="Job is running"></i>{%endif%}
                    {%if ds == 'not sure'%}<i class="icon-question-sign" rel="tooltip" title="Not sure"></i>{%endif%}
                {% endwith%}
            {%endif%}
        {% endwith%}
        {{jobAttempt}}
    </h1>
</div>

<dl class="dl-horizontal">
<dt>Shell Script</dt><dd><pre class="pre-scrollable">{{jobAttempt.get_command_shell_script_text}}</pre></dd>
<dt><em>time</em> Output</dt><dd><a href="{% url jobAttempt_profile_output jobAttempt.id%}"><code>{{jobAttempt.profile_output_path}}</code></a></dd>
<dt>Output Directory</dt><dd><code>{{jobAttempt.task.job_output_dir}}</code></dd>
<dt>Task File Size</dt><dd>{%if settings.show_jobAttempt_file_sizes%}{{jobAttempt.file_size}}{%else%}OFF{%endif%}</dd>
<dt>Outputs<strong></strong></dt>
{% for key,val in jobAttempt.task.output_paths.items %}
<dd><em>{{key}}</em>: <a href="{% url jobAttempt_output jobAttempt.id key%}"><code>{{val}}</code></a></dd>
{% empty %}
<dd>None</dd>
{%endfor%}

<dt>Successful</dt>    <dd>{{jobAttempt.successful}}</dd>
<dt>Queue_status</dt>  <dd>{{jobAttempt.queue_status}}</dd>
<dt>Created On</dt>  <dd>{{jobAttempt.created_on}}</dd>
<dt>Finished On</dt>  <dd>{{jobAttempt.finished_on}}</dd>
<dt>Drmaa JobID</dt>  <dd>{{jobAttempt.drmaa_jobID}}</dd>
<dt>Drmaa status</dt>  <dd>{{jobAttempt.get_drmaa_status}}</dd>
<dt>Drmaa native_specification</dt>  <dd>{{jobAttempt.drmaa_native_specification}}</dd>
<dt>Drmaa info</dt>  <dd>{{jobAttempt.drmaa_info}}</dd>
</dl>
<p>
<button class="btn btn-medium btn-inverse" data-toggle="collapse" data-target="#demo" >Resource Usage <i class="icon icon-resize-full icon-white"></i></button>
</p>
<div id="demo" class="collapse">
<table class="table table-condensed">
	<thead>
	<tr><th>Name</th><th style="padding:0 35px">Value</th><th style="padding:0 35px">Type</th><th>Description</th></tr>
	</thead>
	<tbody>
	{%for name,val,help,type in jobAttempt.resource_usage %}
		<tr>
			<td style="vertical-align:middle"><em>{{name|underscore2space}}</em></td>
			<td style="padding:0 35px; vertical-align:middle">{% format_resource_usage name val help %}</td>
			<td style="padding:0 35px; vertical-align:middle">{{type}}</td>
			<td><small>{{help}}</small></td>
		</tr>
		{% empty %}
		<tr><td colspan="4">No Resource Usage Data.</td></tr>
	{%endfor%}
	</tbody>
</table>
	
</div>

<fieldset><legend>STDOUT</legend>
<p>
file_path: <code>{{jobAttempt.STDOUT_filepath}}</code>
</p>
<pre class="pre-scrollable">
{{jobAttempt.STDOUT_txt}}
</pre>
</fieldset>

<fieldset><legend>STDERR</legend>
<p>
file_path: <code>{{jobAttempt.STDERR_filepath}}</code>
</p>
<pre class="pre-scrollable">
{{jobAttempt.STDERR_txt}}
</pre>
</fieldset>
{%endblock%}